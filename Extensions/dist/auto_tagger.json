{"id":"auto_tagger","script":"//* TITLE Auto Tagger **//\n//* VERSION 0.6.4 **//\n//* DESCRIPTION Tags posts automatically. **//\n//* DEVELOPER STUDIOXENIX **//\n//* DETAILS This extension allows you to automatically add tags to posts based on state (reblogged, original, queued) or post type (audio, video, etc) and keeping original tags while reblogging a post. **//\n//* FRAME false **//\n//* BETA false **//\n\nXKit.extensions.auto_tagger = new Object({\n\n\trunning: false,\n\n\tpreferences: {\n\n\t\t\"sep0\": {\n\t\t\ttext: \"Keeping Tags\",\n\t\t\ttype: \"separator\",\n\t\t},\n\n\t\t\"keep_tags\": {\n\t\t\ttext: \"Keep original tags when I'm reblogging a post\",\n\t\t\tdefault: false,\n\t\t\tvalue: false\n\t\t},\n\n\t\t\"sep1\": {\n\t\t\ttext: \"Tags by Type\",\n\t\t\ttype: \"separator\",\n\t\t},\n\n\t\t\"tag_for_text\": {\n\t\t\ttext: \"Tags for Text Posts\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"\",\n\t\t\tvalue: \"\"\n\t\t},\n\n\t\t\"tag_for_ask\": {\n\t\t\ttext: \"Tags for reblogged Ask Posts\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"\",\n\t\t\tvalue: \"\"\n\t\t},\n\n\t\t\"tag_for_photo\": {\n\t\t\ttext: \"Tags for Photo/Photoset Posts\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"\",\n\t\t\tvalue: \"\"\n\t\t},\n\n\t\t\"tag_for_quote\": {\n\t\t\ttext: \"Tags for Quote Posts\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"\",\n\t\t\tvalue: \"\"\n\t\t},\n\n\t\t\"tag_for_link\": {\n\t\t\ttext: \"Tags for Link Posts\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"\",\n\t\t\tvalue: \"\"\n\t\t},\n\n\t\t\"tag_for_chat\": {\n\t\t\ttext: \"Tags for Chat Posts\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"\",\n\t\t\tvalue: \"\"\n\t\t},\n\n\t\t\"tag_for_audio\": {\n\t\t\ttext: \"Tags for Audio Posts\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"\",\n\t\t\tvalue: \"\"\n\t\t},\n\n\t\t\"tag_for_video\": {\n\t\t\ttext: \"Tags for Video Posts\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"\",\n\t\t\tvalue: \"\"\n\t\t},\n\n\t\t\"sep2\": {\n\t\t\ttext: \"Tags by State\",\n\t\t\ttype: \"separator\",\n\t\t},\n\n\t\t\"tag_for_original\": {\n\t\t\ttext: \"Tags for posts I create\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"\",\n\t\t\tvalue: \"\"\n\t\t},\n\n\t\t\"tag_for_reblogged\": {\n\t\t\ttext: \"Tags for posts I reblog\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"\",\n\t\t\tvalue: \"\"\n\t\t},\n\n\t\t\"tag_for_queued\": {\n\t\t\ttext: \"Tags for Queued Posts\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"\",\n\t\t\tvalue: \"\"\n\t\t},\n\n\t\t\"sep3\": {\n\t\t\ttext: \"Miscellaneous\",\n\t\t\ttype: \"separator\",\n\t\t},\n\n\t\t\"tag_person\": {\n\t\t\ttext: \"When reblogging, tag with the URL of the person I'm reblogging from\",\n\t\t\tdefault: false,\n\t\t\tvalue: false\n\t\t},\n\n\t\t\"tag_person_replace_hyphens\": {\n\t\t\ttext: \"Replace hyphens in usernames with spaces\",\n\t\t\tdefault: false,\n\t\t\tvalue: false\n\t\t},\n\n\t\t\"tag_date\": {\n\t\t\ttext: \"Tag with date (ie: <i>#August 21th 2013, #August, #21th, #2013</i>)\",\n\t\t\tdefault: false,\n\t\t\tvalue: false\n\t\t}\n\n\t},\n\n\tnew_post_check_interval: 0,\n\trun: function() {\n\t\tthis.running = true;\n\t\tnew_post_check_interval = setInterval(function() { XKit.extensions.auto_tagger.new_post_check(); }, 1000);\n\t},\n\n\treblog_do: function() {\n\n\t\tif ($(\".post-header\").length <= 0) { setTimeout(function() { XKit.extensions.auto_tagger.reblog_do(); }, 100); return; }\n\n\t\tif ($(\"#post_state\").val() === \"2\") {\n\t\t\tif (XKit.extensions.auto_tagger.preferences.tag_for_queued.value !== \"\") {\n\t\t\t\tif (XKit.extensions.auto_tagger.check_if_tag_exists(XKit.extensions.auto_tagger.preferences.tag_for_queued.value) === false) {\n\t\t\t\t\tXKit.extensions.auto_tagger.inject_to_window(XKit.extensions.auto_tagger.preferences.tag_for_queued.value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (XKit.extensions.auto_tagger.preferences.tag_for_queued.value !== \"\") {\n\t\t\t\tif (XKit.extensions.auto_tagger.check_if_tag_exists(XKit.extensions.auto_tagger.preferences.tag_for_queued.value) === true) {\n\t\t\t\t\t// Remove tag.\n\t\t\t\t\tXKit.extensions.auto_tagger.remove_tag(XKit.extensions.auto_tagger.preferences.tag_for_queued.value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t},\n\n\tcheck_if_tag_exists: function(tag) {\n\t\treturn XKit.interface.tag_exists(tag);\n\t},\n\n\tnew_post_check: function() {\n\n\t\tvar original = true;\n\t\tif (document.location.href.indexOf(\"://www.tumblr.com/reblog/\") !== -1) {\n\t\t\toriginal = false;\n\t\t} else if (document.location.href.indexOf(\"://www.tumblr.com/new/\") === -1) {\n\t\t\t// Url is wrong for a new post, neither new nor reblog\n\t\t\treturn;\n\t\t}\n\n\t\tvar post_forms = $(\".post-form\");\n\n\t\tXKit.console.add(\"Auto Tagger -> new_post_check -> user in new post page!\");\n\n\t\tif(post_forms.length <= 0) {\n\t\t\tXKit.console.add(\"Auto Tagger -> new_post_check -> delaying, not on page...\");\n\t\t\treturn;\n\t\t}\n\n\t\tvar post_form = $(post_forms[0]);\n\n\t\tif (post_form.hasClass(\"xkit-auto-tagger-done\") === true) {\n\t\t\tXKit.console.add(\"Auto Tagger -> new_post_check -> quitting, already done.\");\n\t\t\treturn;\n\t\t}\n\n\t\tXKit.console.add(\"Auto Tagger -> new_post_check -> page is shown.\");\n\n\t\tpost_form.addClass(\"xkit-auto-tagger-done\");\n\n\t\tvar post_object = null;\n\t\tif (original) {\n\t\t\t// Create fake post object:\n\t\t\tvar type = XKit.interface.post_window.type();\n\t\t\tpost_object = {type: type, tags: '', owner: ''};\n\t\t} else {\n\t\t\tvar post_id = document.location.href.match(/tumblr.com\\/reblog\\/(\\d+)\\//)[1];\n\t\t\tpost_object = XKit.interface.find_post(post_id);\n\t\t}\n\n\t\tvar m_tags = this.return_tags(post_object, original);\n\n\t\tif (m_tags !== \"\") {\n\t\t\tthis.inject_to_window(m_tags);\n\t\t}\n\t},\n\n\treturn_date_tag: function() {\n\n\t\tvar nowdate = new Date();\n\t\tvar nowdatem = moment(nowdate);\n\t\tvar m_date = nowdatem.format(\"Do[,]MMMM[,]YYYY[,]MMMM Do YYYY\");\n\t\treturn m_date;\n\n\t},\n\n\t/**\n\t * Return tags for the post object returned by XKit.interface.post or\n\t * XKit.interface.find_post.\n\t * Uses tag_for_reblogged, tag_for_original, tag_based_on_type, keep_tags,\n\t * some weird bullshit, tag_person, and tag_date\n\t */\n\treturn_tags: function(obj, original) {\n\n\t\tvar to_return = \"\";\n\n\t\tif (typeof XKit.interface === \"undefined\") { return \"\"; }\n\n\t\tif (!original) {\n\t\t\tto_return = this.mreturn_add(to_return, XKit.extensions.auto_tagger.preferences.tag_for_reblogged.value);\n\t\t}\n\n\t\tif (original) {\n\t\t\tto_return = this.mreturn_add(to_return, XKit.extensions.auto_tagger.preferences.tag_for_original.value);\n\t\t}\n\n\t\tto_return = this.mreturn_add(to_return, XKit.extensions.auto_tagger.return_tag_based_on_type(obj));\n\n\t\tif (XKit.extensions.auto_tagger.preferences.keep_tags.value) {\n\t\t\tto_return = this.mreturn_add(to_return, obj.tags);\n\t\t}\n\n\t\tif (XKit.extensions.auto_tagger.preferences.keep_tags.value) {\n\n\t\t\tif ($(\"body\").attr('data-page-root').indexOf('/tagged/') !== -1) {\n\t\t\t\tvar m_search_tag = $(\"body\").attr('data-page-root').substring(8);\n\t\t\t\tm_search_tag = decodeURIComponent(m_search_tag);\n\t\t\t\tm_search_tag = XKit.tools.replace_all(m_search_tag, \"\\\\+\", \" \");\n\t\t\t\tm_search_tag = XKit.tools.replace_all(m_search_tag, \"\\\\-\", \" \");\n\t\t\t\tif (m_search_tag.indexOf(\"?before=\") !== -1) {\n\t\t\t\t\tm_search_tag = m_search_tag.substring(0, m_search_tag.indexOf('?before='));\n\t\t\t\t}\n\n\t\t\t\tif (m_search_tag.indexOf('/everything') !== -1) {\n\t\t\t\t\tm_search_tag = m_search_tag.substring(0, m_search_tag.indexOf('/everything'));\n\t\t\t\t}\n\t\t\t\tto_return = this.mreturn_add(to_return, m_search_tag);\n\t\t\t}\n\n\t\t}\n\n\t\tif (XKit.extensions.auto_tagger.preferences.tag_person.value && obj.owner !== \"\") {\n\t\t\tif (XKit.extensions.auto_tagger.preferences.tag_person_replace_hyphens.value) {\n\t\t\t\tto_return = this.mreturn_add(to_return, obj.owner.replace(/-/g, ' '));\n\t\t\t} else {\n\t\t\t\tto_return = this.mreturn_add(to_return, obj.owner);\n\t\t\t}\n\n\t\t}\n\n\t\tif (XKit.extensions.auto_tagger.preferences.tag_date.value) {\n\t\t\tvar m_date = XKit.extensions.auto_tagger.return_date_tag();\n\t\t\tto_return = this.mreturn_add(to_return, m_date);\n\t\t}\n\n\t\tif ($.trim(to_return) !== \"\") {\n\t\t\treturn to_return;\n\t\t} else {\n\t\t\treturn \"\";\n\t\t}\n\n\t},\n\n\treturn_tag_based_on_type: function(obj) {\n\n\t\tif ((obj.type === \"regular\" || obj.type === \"text\") && XKit.extensions.auto_tagger.preferences.tag_for_text.value !== \"\") {\n\t\t\treturn XKit.extensions.auto_tagger.preferences.tag_for_text.value;\n\t\t}\n\n\t\tif (obj.type === \"note\" && XKit.extensions.auto_tagger.preferences.tag_for_text.value !== \"\") {\n\t\t\treturn XKit.extensions.auto_tagger.preferences.tag_for_ask.value;\n\t\t}\n\n\t\tif (obj.type === \"photo\" && XKit.extensions.auto_tagger.preferences.tag_for_photo.value !== \"\") {\n\t\t\treturn XKit.extensions.auto_tagger.preferences.tag_for_photo.value;\n\t\t}\n\n\t\tif (obj.type === \"photoset\" && XKit.extensions.auto_tagger.preferences.tag_for_photo.value !== \"\") {\n\t\t\treturn XKit.extensions.auto_tagger.preferences.tag_for_photo.value;\n\t\t}\n\n\t\tif (obj.type === \"quote\" && XKit.extensions.auto_tagger.preferences.tag_for_quote.value !== \"\") {\n\t\t\treturn XKit.extensions.auto_tagger.preferences.tag_for_quote.value;\n\t\t}\n\n\t\tif (obj.type === \"link\" && XKit.extensions.auto_tagger.preferences.tag_for_link.value !== \"\") {\n\t\t\treturn XKit.extensions.auto_tagger.preferences.tag_for_link.value;\n\t\t}\n\n\t\tif (obj.type === \"conversation\" && XKit.extensions.auto_tagger.preferences.tag_for_chat.value !== \"\") {\n\t\t\treturn XKit.extensions.auto_tagger.preferences.tag_for_chat.value;\n\t\t}\n\n\t\tif (obj.type === \"audio\" && XKit.extensions.auto_tagger.preferences.tag_for_audio.value !== \"\") {\n\t\t\treturn XKit.extensions.auto_tagger.preferences.tag_for_audio.value;\n\t\t}\n\n\t\tif (obj.type === \"video\" && XKit.extensions.auto_tagger.preferences.tag_for_video.value !== \"\") {\n\t\t\treturn XKit.extensions.auto_tagger.preferences.tag_for_video.value;\n\t\t}\n\n\t\treturn \"\";\n\n\t},\n\n\treturn_tags_for_queue: function() {\n\t\treturn this.preferences.tag_for_queued.value;\n\t},\n\n\tmreturn_add: function(m_return, tag) {\n\t\tif (m_return === \"\") {\n\t\t\treturn tag;\n\t\t} else if (tag !== \"\" && typeof(tag) === 'string') {\n\t\t\treturn m_return + \",\" + tag;\n\t\t} else {\n\t\t\treturn m_return;\n\t\t}\n\t},\n\n\tremove_tag: function(tag) {\n\t\tXKit.interface.post_window.remove_tag(tag);\n\t},\n\n\tinject_to_window: function(raw_string) {\n\n\t\tif($(\".post-form\").length <= 0) {\n\t\t\tsetTimeout(function() {\n\t\t\t\tXKit.extensions.auto_tagger.inject_to_window(raw_string);\n\t\t\t}, 200);\n\t\t\treturn;\n\t\t}\n\n\t\tvar tags = raw_string.split(\",\");\n\t\tXKit.interface.post_window.add_tag(tags);\n\t},\n\n\tdestroy: function() {\n\t\tthis.running = false;\n\t}\n\n});\n","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MEIyQzEzNUVGMjMwMTFFMjk0ODRGOUZBRTFFQ0RCQjUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MEIyQzEzNUZGMjMwMTFFMjk0ODRGOUZBRTFFQ0RCQjUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFOTM5NUFGRkYyMjgxMUUyOTQ4NEY5RkFFMUVDREJCNSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFOTM5NUIwMEYyMjgxMUUyOTQ4NEY5RkFFMUVDREJCNSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgmNBKYAAAfRSURBVHjalFZraFTp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","title":"Auto Tagger","description":"Tags posts automatically.","developer":"STUDIOXENIX","version":"0.6.4","frame":"false","beta":"false","details":"This extension allows you to automatically add tags to posts based on state (reblogged, original, queued) or post type (audio, video, etc) and keeping original tags while reblogging a post.","file":"found","server":"up","errors":false,"slow":"false"}